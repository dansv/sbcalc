<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>SB calc</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="github-light.css" media="screen">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Local meta Humans sideboard calculator</h1>
      <h2>A way to calculate the optimal sideboard and flex slots for humans</h2>
    </section>
  
    <section class="main-content">
      <label>Add Opponents deck</label><input type="text" id="deck_name" placeholder="Name of an opponents deck">
      <button type="button" id="add_opp_deck">Spara</button>
      <h2>Opposing Decks</h2>
      <div id="opp_decks"></div>
      <h2>Great cards</h2>
      <div id="result"></div>
    </section>
    <!-- Hämta calculations.js -->
    <script type="text/javascript">
      function printTable(scores) {
        $("div#result").html("<table><thead><th>Card</th><th>Score</th></thead><tbody>")
        console.log("scores")
        console.log(scores)
        $.each(scores, function(key, obj) {
          console.log(obj)
          $("div#result").append("<tr><td>" + obj.card + "</td><td>" + obj.score + "</td></tr>")  
        })
        $("div#result").append("</tbody></table>")
      }
      function updateScores(deck_name, scores, ratings) {
        $.each(ratings, function(key, rating) {
          if (deck_name == rating.deck_name) {
            console.log("rating.cards")
            console.log(rating.cards)
            $.each(scores, function(key2, score) {
              console.log(score.card)
              $.each(rating.cards, function(key3, card) {
                if (score.card == card.name) {
                  score.score += card.score
                }
              })
            })
          }
        })
        return scores
      }
      $(document).ready(function() {
        let deck_names = []
        let scores = []
        let ratings = []
        $.ajax({
          url: "score.json",
          dataType: "json",
          success: function(response) {
            console.log("Got score.json")
            $.each(response, function(key, val) {
              scores.push({card: key, score: val})
            })
            printTable(scores)
          }
        })
        $.ajax({
          url: "ratings.json",
          dataType: "json",
          success: function(response) {
            console.log("Got ratings.json")
            $.each(response, function(key, val) {
              console.log("key: " + key)
              $.each(val, function (key2, val2) {
                console.log("key2: " + key2)
                console.log(val2)
              })
            })
          }
        })
        $("#add_opp_deck").on("click", function(){
          let deck_name = $("#deck_name").val()
          console.log(deck_name)
          if (deck_name !== "") {
            deck_names.push(deck_name)
          }
          $("#opp_decks").html("<ul>")
          $.each(deck_names, function(key, value){
            $("#opp_decks").append("<li>" + value + "</li>")
          })
          $("#opp_decks").append("</ul>")
          printTable(scores)
        })
      })
    </script>
  
  </body>

</html>

